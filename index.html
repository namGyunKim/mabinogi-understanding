<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê¸¸ë“œ ê°€ì… ì‹ ì²­ (ë””ìŠ¤ì½”ë“œ)</title>
    <style>
        /* CSS ìŠ¤íƒ€ì¼ì€ ì›ë³¸ê³¼ ë™ì¼í•˜ê²Œ ìœ ì§€ë©ë‹ˆë‹¤ */
        body {
            font-family: sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        input[type="text"],
        textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
            resize: vertical;
        }
        .rules-agreement {
            margin-bottom: 20px;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 4px;
            border: 1px solid #eee;
        }
        .rules-agreement label {
            font-weight: normal;
            display: flex;
            align-items: center;
        }
        .rules-agreement input[type="checkbox"] {
            margin-right: 10px;
        }
        button {
            display: block;
            width: 100%;
            padding: 12px;
            background-color: #5cb85c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }
        button:hover:not(:disabled) { /* ë¹„í™œì„±í™” ìƒíƒœ ì•„ë‹ ë•Œë§Œ hover íš¨ê³¼ */
            background-color: #4cae4c;
        }
        button:disabled { /* ì „ì†¡ ì¤‘ ë¹„í™œì„±í™” ìŠ¤íƒ€ì¼ */
            background-color: #cccccc;
            cursor: not-allowed;
        }
        .status-message { /* ì „ì†¡ ìƒíƒœ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
            margin-top: 15px;
            text-align: center;
            font-weight: bold;
        }
        .status-message.success {
            color: green;
        }
        .status-message.error {
            color: red;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ê¸¸ë“œ ê°€ì… ì‹ ì²­</h1>
        <form id="guild-application-form">
            <div>
                <label for="character-name">ìºë¦­í„°ëª… / ë‹‰ë„¤ì„:</label>
                <input type="text" id="character-name" name="character_name" placeholder="ê²Œì„ ë‚´ ìºë¦­í„°ëª… ë˜ëŠ” ë‹‰ë„¤ì„" required>
            </div>

            <div>
                <label for="contact-info">ì—°ë½ì²˜ (ì„ íƒ):</label>
                <input type="text" id="contact-info" name="contact_info" placeholder="ì˜ˆ: ë””ìŠ¤ì½”ë“œ ID (user#1234)">
            </div>

            <div>
                <label for="introduction">ê°€ì… ì‹ ì²­ ì´ìœ  / ìê¸°ì†Œê°œ:</label>
                <textarea id="introduction" name="introduction" placeholder="ê°„ë‹¨í•œ ìê¸°ì†Œê°œì™€ ê¸¸ë“œì— ê°€ì…í•˜ë ¤ëŠ” ì´ìœ ë¥¼ ì ì–´ì£¼ì„¸ìš”." required></textarea>
            </div>

            <div class="rules-agreement">
                <label for="rules-agree">
                    <input type="checkbox" id="rules-agree" name="rules_agree" value="agreed" required> ê¸¸ë“œ ê·œì¹™ì„ ëª¨ë‘ í™•ì¸í–ˆìœ¼ë©°, ì´ì— ë™ì˜í•©ë‹ˆë‹¤.
                </label>
            </div>

            <button type="submit" id="submit-button">ì‹ ì²­ì„œ ì œì¶œ (ë””ìŠ¤ì½”ë“œ)</button>
        </form>
        <div id="status-message" class="status-message"></div>
        </div>

    <script>
      // ================================================================
      // ë””ìŠ¤ì½”ë“œ ì›¹í›… ì—°ë™ ìŠ¤í¬ë¦½íŠ¸
      // ================================================================

      // ì¤‘ìš”: ì•„ë˜ ë³€ìˆ˜ì— ì‹¤ì œ ë””ìŠ¤ì½”ë“œ ì›¹í›… URLì„ ì…ë ¥í•˜ì„¸ìš”.
      const webhookUrl = 'https://discord.com/api/webhooks/1364502278958092388/2B7k4chVb08HX_o6w5LTq8kyhkRqIYmOpn3UKe62CEU62Y55K3aUcO3NDSv2lCJy6yxf';

      const form = document.getElementById('guild-application-form');
      const submitButton = document.getElementById('submit-button');
      const statusMessage = document.getElementById('status-message');

      form.addEventListener('submit', function(event) {
        event.preventDefault(); // í¼ì˜ ê¸°ë³¸ ì œì¶œ ë™ì‘(í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨) ë°©ì§€

        // 0. ì „ì†¡ ìƒíƒœ ì´ˆê¸°í™” ë° ë²„íŠ¼ ë¹„í™œì„±í™”
        statusMessage.textContent = 'ì „ì†¡ ì¤‘...';
        statusMessage.className = 'status-message'; // ê¸°ë³¸ í´ë˜ìŠ¤ë¡œ ì´ˆê¸°í™”
        submitButton.disabled = true; // ì—¬ëŸ¬ ë²ˆ í´ë¦­ ë°©ì§€

        // 1. í¼ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const characterName = document.getElementById('character-name').value.trim();
        const contactInfo = document.getElementById('contact-info').value.trim();
        const introduction = document.getElementById('introduction').value.trim();
        const rulesAgree = document.getElementById('rules-agree').checked;

        // 2. ìœ íš¨ì„± ê²€ì‚¬ (ê·œì¹™ ë™ì˜ í•„ìˆ˜)
        if (!rulesAgree) {
          statusMessage.textContent = 'ê¸¸ë“œ ê·œì¹™ì— ë™ì˜í•´ì•¼ í•©ë‹ˆë‹¤.';
          statusMessage.classList.add('error');
          submitButton.disabled = false; // ë²„íŠ¼ ë‹¤ì‹œ í™œì„±í™”
          return; // ì „ì†¡ ì¤‘ë‹¨
        }
        if (!characterName || !introduction) {
            statusMessage.textContent = 'ìºë¦­í„°ëª…ê³¼ ìê¸°ì†Œê°œëŠ” í•„ìˆ˜ í•­ëª©ì…ë‹ˆë‹¤.';
            statusMessage.classList.add('error');
            submitButton.disabled = false;
            return;
        }


        // 3. ë””ìŠ¤ì½”ë“œ ì›¹í›… í˜ì´ë¡œë“œ(ì „ì†¡í•  ë°ì´í„°) êµ¬ì„±
        //    embeds í˜•ì‹ì„ ì‚¬ìš©í•˜ë©´ ë””ìŠ¤ì½”ë“œì—ì„œ ë” ë³´ê¸° ì¢‹ê²Œ í‘œì‹œë©ë‹ˆë‹¤.
        const payload = {
          username: "ê¸¸ë“œ ê°€ì… ì‹ ì²­ë´‡", // ì›¹í›… ë©”ì‹œì§€ì— í‘œì‹œë  ì´ë¦„ (ì„ íƒ ì‚¬í•­)
          avatar_url: "", // ì›¹í›… ë©”ì‹œì§€ì— í‘œì‹œë  í”„ë¡œí•„ ì‚¬ì§„ URL (ì„ íƒ ì‚¬í•­)
          embeds: [{
            title: "âœ¨ ìƒˆë¡œìš´ ê¸¸ë“œ ê°€ì… ì‹ ì²­",
            color: 5814783, // 16ì§„ìˆ˜ ìƒ‰ìƒ ì½”ë“œ (ì˜ˆ: ë…¹ìƒ‰ ê³„ì—´)
            fields: [
              {
                name: "ğŸ‘¤ ìºë¦­í„°ëª…",
                value: characterName,
                inline: true // ê°€ëŠ¥í•˜ë©´ ì˜†ìœ¼ë¡œ í‘œì‹œ
              },
              {
                name: "ğŸ“ ì—°ë½ì²˜",
                value: contactInfo || "*ì…ë ¥ ì—†ìŒ*", // ì…ë ¥ ì•ˆí–ˆì„ ê²½ìš° ëŒ€ì²´ í…ìŠ¤íŠ¸
                inline: true
              },
              {
                name: "ğŸ“ ìê¸°ì†Œê°œ",
                value: introduction
              }
            ],
            footer: {
              text: "ê·œì¹™ ë™ì˜ ì™„ë£Œ âœ…" // ê·œì¹™ ë™ì˜ ì—¬ë¶€ í‘œì‹œ
            },
            timestamp: new Date().toISOString() // ì‹ ì²­ ì‹œê°„ í‘œì‹œ
          }]
        };

        // 4. fetch APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹í›… URLë¡œ POST ìš”ì²­ ë³´ë‚´ê¸°
        fetch(webhookUrl, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(payload), // JavaScript ê°ì²´ë¥¼ JSON ë¬¸ìì—´ë¡œ ë³€í™˜
        })
        .then(response => {
          if (response.ok) {
            // ì„±ê³µ ì‹œ
            statusMessage.textContent = 'âœ… ì‹ ì²­ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì œì¶œë˜ì—ˆìŠµë‹ˆë‹¤!';
            statusMessage.classList.add('success');
            form.reset(); // í¼ í•„ë“œ ì´ˆê¸°í™”
          } else {
            // ì‹¤íŒ¨ ì‹œ (ë””ìŠ¤ì½”ë“œ ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜)
            statusMessage.textContent = `âŒ ì‹ ì²­ì„œ ì œì¶œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. (ì˜¤ë¥˜: ${response.status})`;
            statusMessage.classList.add('error');
            console.error('Webhook error:', response.status, response.statusText);
          }
        })
        .catch(error => {
          // ì‹¤íŒ¨ ì‹œ (ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ë“±)
          statusMessage.textContent = 'âŒ ì‹ ì²­ì„œ ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
          statusMessage.classList.add('error');
          console.error('Fetch error:', error);
        })
        .finally(() => {
          // ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ë²„íŠ¼ ë‹¤ì‹œ í™œì„±í™”
          submitButton.disabled = false;
        });
      });

      // ì›¹í›… URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ì„ ê²½ìš° ê²½ê³ 
      if (webhookUrl === 'ì—¬ê¸°ì—_ì‹¤ì œ_ë””ìŠ¤ì½”ë“œ_ì›¹í›…_URLì„_ì…ë ¥í•˜ì„¸ìš”') {
          console.warn("ê²½ê³ : ìŠ¤í¬ë¦½íŠ¸ ë‚´ì˜ webhookUrl ë³€ìˆ˜ì— ì‹¤ì œ ë””ìŠ¤ì½”ë“œ ì›¹í›… URLì„ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.");
          statusMessage.textContent = 'âš ï¸ ì›¹í›… URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê´€ë¦¬ìì—ê²Œ ë¬¸ì˜í•˜ì„¸ìš”.';
          statusMessage.classList.add('error');
          submitButton.disabled = true; // URL ì—†ìœ¼ë©´ ì œì¶œ ë¶ˆê°€
      }

    </script>
</body>
</html>
